<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {%- seo -%}
  <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  {%- feed_meta -%}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}

<!--  检测主题-->
  <script>
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
    }

    // function initTheme() {
    //   const savedTheme = localStorage.getItem('theme');
    //   const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    //   setTheme(savedTheme || (prefersDark ? 'dark' : 'light'));
    // }

    function initTheme() {
      setTheme(getPreferredTheme());

      // 监听系统主题变化
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) { // 仅在未手动设置时自动变更
          setTheme(e.matches ? 'dark' : 'light');
        }
      });
    }

    initTheme();
  </script>

</head>
